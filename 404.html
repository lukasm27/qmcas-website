<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Not Found - QMCAS</title>
    
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <!-- Paste your full header code here -->
    </header>

    <main>
        <div class="container error-page-content">
            <h1>Access Restricted</h1>
            <p>The page you are trying to access is for QMCAS mentees only.</p>
            <p>Please log in to view this content.</p>
            <button class="cta-button" onclick="netlifyIdentity.open()">Log In or Sign Up</button>
        </div>
    </main>

    <footer>
    </footer>
    <script src="nav.js"></script>
    <script>
      if (window.netlifyIdentity) {
        // The 'init' event fires once the widget is ready
        // and knows if a user is logged in or not.
        window.netlifyIdentity.on('init', function(user) {
          
          if (user) {
            // A user is ALREADY logged in, but they've landed on this error page.
            // This means they are stuck in a redirect loop.
            // The safest way to break the loop is to send them to a public page.
            // From the homepage, they can click the link again and it will work.
            window.location.href = "/"; 
          } else {
            // No user is logged in. This is the correct path for a non-member.
            // We set up the listener for when they DO successfully log in.
            window.netlifyIdentity.on('login', function() {
              // After they log in, send them to the page they were trying to access.
              const intendedDestination = sessionStorage.getItem('netlify-identity-redirect');
              window.location.href = intendedDestination || "/accelerator.html";
            });
            
            // Since they are not logged in, the redirect rule should have already
            // triggered the login modal. This is a fallback just in case.
            window.netlifyIdentity.open();
          }
        });
      }
    </script>
</body>
</html>
